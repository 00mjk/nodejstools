<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Fragment>
        <DirectoryRef Id="INSTALLLOCATION">
            <Directory Id="DIR_ProjectTemplates_4DCCAA275A2C4923918F2CBC07199083" Name="ProjectTemplates" />
            <Directory Id="DIR_FileTemplates_867246A15C254AAAA0099E75615C893A" Name="FileTemplates">
              <Directory Id="DIR_NewItem_8C4602C9B0A2476697A95E2BF5B94B53" Name="NewItem"/>
            </Directory>
        </DirectoryRef>
        <DirectoryRef Id="INSTALLLOCATION">
            <Directory Id="GAC" Name="GAC" />
        </DirectoryRef>
    </Fragment>
    <Fragment>
        <ComponentGroup Id="NodejsToolsExt">
            <!-- Per user components -->
            <Component Id="PerUserInstallRegistry" Directory="INSTALLLOCATION" Guid="{07CBA996-E490-4F22-87C0-069BAF855D68}">
                <Condition>NOT ALLUSERS = 1</Condition>
                <RegistryKey Root='HKCU' Key='Software\Microsoft\VisualStudio\$(var.VSTargetVersion)\ExtensionManager\EnabledExtensions'>
                    <RegistryValue Type='string' Name='4219f2a8-fbf9-4659-a222-b7580a60eebb,1.0' Value='[EXTENSION_INSTALLPATH]Extensions\Microsoft\Node.js Tools\1.0\'/>
                </RegistryKey>
                <RegistryKey Root='HKCU' Key='Software\Microsoft\VisualStudio\$(var.VSTargetVersion)\ExtensionManager\ExtensionTypes'>
                    <RegistryValue Type='string' Name='4219f2a8-fbf9-4659-a222-b7580a60eebb,1.0' Value='Tool'/>
                </RegistryKey>
                <File Id='filVSTemplateStore.pkgdef' Source='$(var.TargetDir)\VSTemplateStore.pkgdef' />
            </Component>
            
            <!-- All user components -->

            <!-- Both per user and all user components -->
            <Component Id="cmpE3F5BF4C28BA41A9A478DAC397C64098" Directory="INSTALLLOCATION" Guid="{DDBCEC41-C59C-4C5D-B7A2-77AB2F7684DB}">
              <File Id="fil47E7513578964CFA86B587D50FC280CB" KeyPath="yes" Source="$(var.BinariesDir)\Microsoft.NodejsTools.dll" />
            </Component>
            <Component Id="cmpMicrosoft.NodejsTools.ProjectWizard.dll" Directory="INSTALLLOCATION" Guid="{5B0F69FB-EBB6-42CF-8422-57C2A492E664}">
              <File Id="filMicrosoft.NodejsTools.ProjectWizard.dll" KeyPath="yes" Source="$(var.BinariesDir)\Microsoft.NodejsTools.ProjectWizard.dll" />
            </Component>
            <Component Id="cmp9FEF8767393C493A8B68D8BF6D4961B5" Directory="INSTALLLOCATION" Guid="{B43D5044-D8D5-42A8-BAEF-1A7DBC21AAE6}">
              <File Id="filE8D2A28B9CB64184A05AEAAF2A2EF4C8" KeyPath="yes" Source="$(var.BinariesDir)\Microsoft.NodejsTools.AjaxMin.dll" />
            </Component>
            <Component Id="cmp8D98477436DB42B0ACE9B536469F60E1" Directory="INSTALLLOCATION" Guid="{0AE160E1-51FF-4153-9882-E89DDFAE07B5}">
              <File Id="filEEA4A429F6A1428CAC96158BA6ADD3F1" KeyPath="yes" Source="$(var.BinariesDir)\NodejsProject.ico" />
            </Component>
            <Component Id="cmpA1538F6E77EE4170BEEC113CBCA174BB" Directory="INSTALLLOCATION" Guid="{60D3CA23-457C-4AA9-AD84-A8992687A234}">
              <File Id="fil0A762C1A17F3488488BB00DB54D656A5" KeyPath="yes" Source="$(var.BinariesDir)\NodejsProjectBig.ico" />
            </Component>
            <Component Id="cmpC4E8CE1ED04F4740A1B017ECE4DA9CD1" Directory="INSTALLLOCATION" Guid="{1CF7A1CB-228A-4FA1-97EC-A9CD4417FF63}">
              <File Id="fil617BFEB8AC8E419B80409E0DD6D4641B" KeyPath="yes" Source="$(var.ObjDir)\extension.vsixmanifest" />
            </Component>
            <Component Id="cmp2F4D073922FD4DB199AC2AC8470BA750" Directory="INSTALLLOCATION" Guid="{99782EAC-E8DD-4FC7-8EBA-58F107CCEB9E}">
              <File Id="fil530034032FEF4DFDBFD9E74C8411CB8C" KeyPath="yes" Source="$(var.BinariesDir)\Microsoft.NodejsTools.pkgdef" />
            </Component>
            <Component Id="cmp31BE00F937684CD0925BD24FB16D6D6D" Directory="INSTALLLOCATION" Guid="{8101FEA9-BE4C-4361-89A7-F438C0B5EB80}">
              <File Id="fil226B6994EA9247808FCA9C6485906CB2" KeyPath="yes" Source="$(var.BinariesDir)\visualstudio_nodejs_repl.js" />
            </Component>
            <Component Id="cmp05C8461645AC4E30883B5F6FC70C2F9B" Directory="INSTALLLOCATION" Guid="{B87AE937-DA4A-4599-B2E9-B9EE139293D1}">
              <File Id="filB3AE8C142D5449D0A2CB178BD4C5EF1F" KeyPath="yes" Source="$(var.BinariesDir)\nodejsref.js" />
            </Component>
            <Component Id="cmp3939064E04124AF7B8F790B3D2EAEFE7" Directory="INSTALLLOCATION" Guid="{8C7344A9-E311-4AF7-9E7F-B6232FD2FA29}">
              <File Id="fil3B2605EA0CF2447BB2857277D59C650F" KeyPath="yes" Source="$(var.BinariesDir)\NoSurveyNewsFeed.html" />
            </Component>
            <Component Id="cmpAzureExpressApp.zip" Directory="DIR_ProjectTemplates_4DCCAA275A2C4923918F2CBC07199083" Guid="{D4213A93-048A-4A0C-BFE2-6ABC6D42644A}">
              <File Id="filAzureExpressApp.zip" KeyPath="yes" Source="$(var.BinariesDir)\ProjectTemplates\JavaScript\AzureExpressApp.zip" />
            </Component>
            <Component Id="cmpAzureNodejsApp.zip" Directory="DIR_ProjectTemplates_4DCCAA275A2C4923918F2CBC07199083" Guid="{94061A1E-94EF-4246-B10F-8E2FD990AC27}">
              <File Id="filAzureNodejsApp.zip" KeyPath="yes" Source="$(var.BinariesDir)\ProjectTemplates\JavaScript\AzureNodejsApp.zip" />
            </Component>
            <Component Id="cmpExpressApp.zip" Directory="DIR_ProjectTemplates_4DCCAA275A2C4923918F2CBC07199083" Guid="{D7612D7F-2AAA-4925-9818-3F638FA04C5C}">
              <File Id="filExpressApp.zip" KeyPath="yes" Source="$(var.BinariesDir)\ProjectTemplates\JavaScript\ExpressApp.zip" />
            </Component>
            <Component Id="cmpNodejsApp.zip" Directory="DIR_ProjectTemplates_4DCCAA275A2C4923918F2CBC07199083" Guid="{2A83D4D0-2334-4FFF-AB7B-8D1D96F0D3FC}">
              <File Id="filNodejsApp.zip" KeyPath="yes" Source="$(var.BinariesDir)\ProjectTemplates\JavaScript\NodejsApp.zip" />
            </Component>
            <Component Id="cmpWebAzureExpressApp.zip" Directory="DIR_ProjectTemplates_4DCCAA275A2C4923918F2CBC07199083" Guid="{86749494-2D16-4AD4-9E86-B3A3ED72DB80}">
              <File Id="filWebAzureExpressApp.zip" KeyPath="yes" Source="$(var.BinariesDir)\ProjectTemplates\JavaScript\WebAzureExpressApp.zip" />
            </Component>
            <Component Id="cmpWebAzureNodejsApp.zip" Directory="DIR_ProjectTemplates_4DCCAA275A2C4923918F2CBC07199083" Guid="{A1770285-15AE-446E-B843-7A3FA82AD3F7}">
              <File Id="filWebAzureNodejsApp.zip" KeyPath="yes" Source="$(var.BinariesDir)\ProjectTemplates\JavaScript\WebAzureNodejsApp.zip" />
            </Component>
            <Component Id="cmpWebExpressApp.zip" Directory="DIR_ProjectTemplates_4DCCAA275A2C4923918F2CBC07199083" Guid="{99D43BE0-92B6-47F2-8512-29189F4117F1}">
              <File Id="filWebExpressApp.zip" KeyPath="yes" Source="$(var.BinariesDir)\ProjectTemplates\JavaScript\WebExpressApp.zip" />
            </Component>
            <Component Id="cmpWebNodejsApp.zip" Directory="DIR_ProjectTemplates_4DCCAA275A2C4923918F2CBC07199083" Guid="{559C2DB8-DBAE-419A-95FE-9F7AE5623875}">
              <File Id="filWebNodejsApp.zip" KeyPath="yes" Source="$(var.BinariesDir)\ProjectTemplates\JavaScript\WebNodejsApp.zip" />
            </Component>
            <Component Id="cmpNodejsTools.targets" Directory="Dir_NodejsToolsMsBuild" Guid="{6D84572F-D895-443F-BD25-712394273A4E}">
                <File Id="filNodejsTools.targets" KeyPath="yes" Source="$(var.BinariesDir)\Microsoft.NodejsTools.targets" />
            </Component>
            <Component Id="cmpWebRole.dll" Directory="Dir_NodejsToolsMsBuild" Guid="{8E1C6566-4E0C-4F70-8735-081B9521660A}">
                <File Id="filWebRole.dll" KeyPath="yes" Source="$(var.BinariesDir)\Microsoft.NodejsTools.WebRole.dll" />
            </Component>

            <Component Id="cmpDB983944C41346E38BA0413248958C3A" Directory="DIR_NewItem_8C4602C9B0A2476697A95E2BF5B94B53" Guid="{007564C3-0035-45B6-8929-E793159D0C72}">
              <File Id="fil227A010D0980483B91EC09B5E42613E5" KeyPath="yes" Source="$(var.BinariesDir)\FileTemplates\NewItem\TextFile.txt" />
            </Component>
            <Component Id="cmpDF185097F0E246D8B0A178F91D9DBFD9" Directory="DIR_NewItem_8C4602C9B0A2476697A95E2BF5B94B53" Guid="{580F274E-4467-48FE-9EDC-80D1E75C1F1D}">
              <File Id="filF10B1C2B44E844F9B012351640ADBC65" KeyPath="yes" Source="$(var.BinariesDir)\FileTemplates\NewItem\NewItems.vsdir" />
            </Component>
            <Component Id="cmp9608E5E0EB994452A7D3A8856F529C38" Directory="DIR_NewItem_8C4602C9B0A2476697A95E2BF5B94B53" Guid="{E4B83B18-E5EF-4D95-93A2-557FD1619A25}">
              <File Id="fil0FF05115771C408E8CD4FFA986AF0459" KeyPath="yes" Source="$(var.BinariesDir)\FileTemplates\NewItem\EmptyJs.js" />
            </Component>

          <!-- WebPI Components -->

        </ComponentGroup>
    </Fragment>
  <!--
    <Fragment>
      <DirectoryRef Id="DIR_Templates_ProjectTemplates_EBEE0B4C969248EA90D7CF43A9566C06" />
    </Fragment>
    <Fragment>
      <DirectoryRef Id="DIR_Templates_ProjectTemplates_NodeAppProject_27837B82E64C4599AFADE3E577B2D5B3" />
    </Fragment>
    <Fragment>
      <DirectoryRef Id="DIR_Templates_4DCCAA275A2C4923918F2CBC07199083">
        <Directory Id="DIR_Templates_ProjectTemplates_EBEE0B4C969248EA90D7CF43A9566C06" Name="ProjectTemplates" />
      </DirectoryRef>
    </Fragment>
    <Fragment>
      <DirectoryRef Id="DIR_Templates_Projects_EBEE0B4C969248EA90D7CF43A9566C06">
        <Directory Id="DIR_Templates_Projects_NodeAppProject_27837B82E64C4599AFADE3E577B2D5B3" Name="NodeAppProject" />
      </DirectoryRef>
    </Fragment>
    -->
</Wix>